# A plotting R script produced by the Revigo server at http://revigo.irb.hr/
# If you found Revigo useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800

# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );

# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );

# --------------------------------------------------------------------------
# Here is your data from Revigo. Scroll down for plot configuration options.

revigo.names <- c("term_ID","description","frequency","plot_X","plot_Y","log_size","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0000156","phosphorelay response regulator activity",0.10002303428214304,-1.553358920443545,4.146383015860532,4.563255573435253,0.9858333049307602,-0),
c("GO:0000310","xanthine phosphoribosyltransferase activity",0.009075354039979026,1.2729276584886653,-7.2502630890575555,3.5211380837040362,0.8899571019438485,0.14814038),
c("GO:0003857","3-hydroxyacyl-CoA dehydrogenase activity",0.030731516738573147,-6.141714233527741,-2.4345489129284634,4.050766311233042,0.8120526800766488,0.50265024),
c("GO:0003858","3-hydroxybutyrate dehydrogenase activity",0.010694097514419396,-6.515776324824206,-2.678677964326786,3.592398846115564,0.8221446927808586,0.46168537),
c("GO:0003863","3-methyl-2-oxobutanoate dehydrogenase (2-methylpropanoyl-transferring) activity",0.010770659705778061,-6.842182828085615,-0.34324810662299576,3.595496221825574,0.8234159182868491,0.46720441),
c("GO:0003960","NADPH:quinone reductase activity",0.006778488299219044,-4.308589796455412,-1.237404127033847,3.3944516808262164,0.8543032862701752,0.19798063),
c("GO:0003961","O-acetylhomoserine aminocarboxypropyltransferase activity",0.006390208614471524,5.374354346410855,-4.160850647261349,3.3688445068258215,0.8954998217632519,0.14504001),
c("GO:0003964","RNA-directed DNA polymerase activity",0.1316158756735012,3.6220030567211627,-4.042249554979125,4.6824609761511855,0.8445825203446364,0.47804567),
c("GO:0004020","adenylylsulfate kinase activity",0.026591689677250986,3.070828029423812,-5.0011814743161365,3.9879342652321585,0.8816857993029457,0.32275728),
c("GO:0004029","aldehyde dehydrogenase (NAD+) activity",0.03624126015242001,-6.714274396506205,-0.8409214086836415,4.1223797320691125,0.8046394374158732,0.64056173),
c("GO:0004035","alkaline phosphatase activity",0.019337422046017377,5.133595556257187,1.1242421507082632,3.8496036580824473,0.9222857548825663,0.29700496),
c("GO:0004049","anthranilate synthase activity",0.02841004172201931,2.596265429473903,5.621649111378989,4.016657344822202,0.8827820222351414,0.49453414),
c("GO:0004061","arylformamidase activity",0.03657758692160272,5.8795541421705435,2.636536292700019,4.126391191616615,0.9297738469409424,0.61099483),
c("GO:0004121","cystathionine beta-lyase activity",0.011621046902654674,2.2836492434418925,5.965937161416612,3.628491104967123,0.9006106600800325,0.28126437),
c("GO:0004160","dihydroxy-acid dehydratase activity",0.03337838106840132,1.9591516961772253,5.579069073360326,4.086644520610805,0.8867680667243109,0.57087716),
c("GO:0004314","[acyl-carrier-protein] S-malonyltransferase activity",0.029036211072774112,0.35588259865664856,-5.951069047393133,4.02612451674545,0.8571750750184456,0.44212262),
c("GO:0004322","ferroxidase activity",0.01969562372701685,-5.951585312998868,0.15536580616241455,3.857573704147496,0.8526373419753304,0.21938594),
c("GO:0004324","ferredoxin-NADP+ reductase activity",0.02174366234586117,-5.494328957046204,-0.7162144655932553,3.900530982452756,0.8518390355010027,0.22311892),
c("GO:0004355","glutamate synthase (NADPH) activity",0.016291340575533306,-5.493234957401595,0.13490098143498358,3.775173385424787,0.8541453777384981,0.21581266),
c("GO:0004365","glyceraldehyde-3-phosphate dehydrogenase (NAD+) (phosphorylating) activity",0.019897966661321896,-6.669913862696781,-0.4792062378696765,3.8620120512502165,0.8154036665025155,0.5958776),
c("GO:0004392","heme oxygenase (decyclizing) activity",0.014667128373138747,-4.81761595956737,-0.4186467043003745,3.72956972630197,0.8503242264770704,0.47279729),
c("GO:0004420","hydroxymethylglutaryl-CoA reductase (NADPH) activity",0.01595774817032769,-6.4543916700569985,-2.4546588804258573,3.7661896933101597,0.818441489691389,0.47469971),
c("GO:0004497","monooxygenase activity",1.2376879793203333,-5.886811153544804,-1.4164762399578945,5.655755808513252,0.8103345239595742,0.3352805),
c("GO:0004517","nitric-oxide synthase activity",0.007328095458615183,-4.7373377875655,-0.10305473926837842,3.4282968139828798,0.8555189184123552,0.19090178),
c("GO:0004519","endonuclease activity",1.2573644624995106,5.64536706997806,1.1041782800897044,5.662605802006163,0.9011705022369081,0.43995601),
c("GO:0004556","alpha-amylase activity",0.02656161167350294,6.685815409941012,0.14167637824581827,3.9874428049358013,0.9334924925703809,0.0167541),
c("GO:0004604","phosphoadenylyl-sulfate reductase (thioredoxin) activity",0.018402269565850813,-4.732816962679965,-2.1633283462217507,3.828079590556746,0.8465590920357022,0.59143066),
c("GO:0004612","phosphoenolpyruvate carboxykinase (ATP) activity",0.01797570878542396,2.5741829638151406,5.265120884829931,3.8178957571617955,0.8826932848647161,0.54342705),
c("GO:0004783","sulfite reductase (NADPH) activity",0.008599574707964458,-4.485486900186897,-2.3318101758361633,3.497758718287268,0.852363616264947,0.20822786),
c("GO:0004810","CCA tRNA nucleotidyltransferase activity",0.019643670811452043,3.717869722162842,-3.872549540459857,3.8564267724702446,0.8593167592125056,0.68968531),
c("GO:0004849","uridine kinase activity",0.01855812831254524,3.6984033374772136,-4.6609471664053945,3.8317418336456384,0.8777240651372042,0.28438204),
c("GO:0004850","uridine phosphorylase activity",0.011295657589380342,1.4080138496088825,-7.127123750590331,3.6161603128475828,0.8887444906387912,0.56366403),
c("GO:0004970","ionotropic glutamate receptor activity",0.04584981516793261,-3.4654505457119615,5.2132754117431634,4.224507164727077,0.932184002941164,0.52275345),
c("GO:0005381","iron ion transmembrane transporter activity",0.05885991897095165,-3.974422880050211,5.5633686983880715,4.332983510816226,0.9326136981831498,0.48319221),
c("GO:0008106","alcohol dehydrogenase (NADP+) activity",0.010300349101717683,-6.308573745116218,-2.805879845330024,3.57611089412084,0.8224844081943441,0.43562948),
c("GO:0008233","peptidase activity",4.315214635541,6.177497308788484,1.372396294635655,6.198146353307567,0.903831374432116,0.21714218),
c("GO:0008253","5'-nucleotidase activity",0.05164119807142027,5.2946538588965435,1.29778553250568,4.276162980319142,0.9179802152199685,0.53403136),
c("GO:0008410","CoA-transferase activity",0.08223326224716157,1.315923736571423,-4.91032033145759,4.478205636011882,0.8988361729678626,0.13740658),
c("GO:0008659","(3R)-hydroxymyristoyl-[acyl-carrier-protein] dehydratase activity",0.028289729707027117,1.9750063833851135,5.765739852048532,4.014814449087053,0.8877347756146521,0.53922257),
c("GO:0008725","DNA-3-methyladenine glycosylase activity",0.02719051538823484,5.895060199554762,-0.5348549718584811,3.9976047874604546,0.9120233893495527,0.46607468),
c("GO:0008728","GTP diphosphokinase activity",0.012053076411035719,3.286737997548737,-5.866121657640421,3.6443400988263224,0.8897052948070645,0.24263968),
c("GO:0008736","L-fucose isomerase activity",0.00534021284726696,-1.2242696341417263,7.080579912358317,3.2909245593827543,0.9538400802832737,0.54782691),
c("GO:0008752","FMN reductase activity",0.003335924052056165,-5.184814269914204,-3.7204373092076364,3.0867156639448825,0.8580995456049708,0.16551428),
c("GO:0008808","cardiolipin synthase activity",0.016868291374700396,3.0225802745785653,-5.468081841966332,3.7902851640332416,0.8876824333648726,0.25620408),
c("GO:0008812","choline dehydrogenase activity",0.007812077882561036,-6.2579248548513275,-3.0691087952393907,3.4560622244549513,0.826888189720319,0.20713358),
c("GO:0008859","exoribonuclease II activity",0.01879328361457543,5.282814029615068,-0.2542872434283203,3.8372095278012064,0.894838877698871,0.58497104),
c("GO:0008863","formate dehydrogenase (NAD+) activity",0.028508478825194736,-6.643969070444668,-0.6729477258172133,4.01815937354091,0.8119005599257934,0.61754299),
c("GO:0008865","fructokinase activity",0.005091385725351295,3.8736074785403343,-5.682782902693281,3.2702128548962426,0.8899230236744382,0.29548467),
c("GO:0008924","malate dehydrogenase (quinone) activity",0.006961690685684424,-6.013246493626106,-3.159086013738838,3.406028944963615,0.8228495515186107,0.42666141),
c("GO:0008955","peptidoglycan glycosyltransferase activity",0.0872453514171771,1.7178866573083658,-6.565923441681993,4.503899583379192,0.8824496508788409,0.44529653),
c("GO:0008959","phosphate acetyltransferase activity",0.01001050652014559,-0.09307891355187714,-6.468860315733058,3.5637183399656776,0.8730635512360723,0.55669156),
c("GO:0009002","serine-type D-Ala-D-Ala carboxypeptidase activity",0.09146174066985793,6.589874059858485,1.3217080306262814,4.524396122103842,0.9236359097770649,0.38744842),
c("GO:0009024","tagatose-6-phosphate kinase activity",0.006267162235502239,3.6956560692730442,-5.4042307171453645,3.3604040547299387,0.8904347754851468,0.14487196),
c("GO:0009032","thymidine phosphorylase activity",0.012610886662363142,1.5696310070097186,-7.091422881015319,3.6639834546082666,0.8881251002232389,0.57392837),
c("GO:0009039","urease activity",0.032276432385631944,5.775005657930134,2.7201602867886385,4.072065991414746,0.9302331021593548,0.14921291),
c("GO:0015116","sulfate transmembrane transporter activity",0.04804550944154006,-4.591888098126751,5.206405530759287,4.244821194593283,0.9264327924808161,0.29922617),
c("GO:0015137","citrate transmembrane transporter activity",0.004128889605413778,-5.051841434953422,5.243943682484267,3.1792644643390253,0.9329050968071377,0.5643334),
c("GO:0015386","potassium:proton antiporter activity",0.007360907826340325,-4.43581360245124,5.471144351943636,3.4302363534115106,0.9217446846561459,0.52211226),
c("GO:0015416","ABC-type phosphonate transporter activity",0.0218393650850595,-4.35933072955429,5.822032643687731,3.902438056198665,0.9381544695133303,0.3653369),
c("GO:0015558","secondary active p-aminobenzoyl-glutamate transmembrane transporter activity",0.005542555781572005,-4.79913157258959,5.526325899144503,3.3070679506612985,0.9329851700962375,0.5215295),
c("GO:0015625","ABC-type ferric hydroxamate transporter activity",5.468727954190434E-06,-3.805647305294901,5.971083594487259,0.47712125471966244,0.9491163838503254,0.00342306),
c("GO:0016151","nickel cation binding",0.11700070021592726,-4.23675091882626,-7.312990072395126,4.631342286483933,0.9952940027738303,0.03657963),
c("GO:0016652","oxidoreductase activity, acting on NAD(P)H, NAD(P) as acceptor",0.04205725233170154,-4.866533658215555,-1.3170917744135096,4.187012807018954,0.8399113927606824,0.58619276),
c("GO:0016661","oxidoreductase activity, acting on other nitrogenous compounds as donors",0.10092810875856158,-6.381234815060441,-1.55419467711702,4.567167577177019,0.8382802850122923,0.24689769),
c("GO:0016775","phosphotransferase activity, nitrogenous group as acceptor",0.9908952242036275,2.621950132989741,-5.202934074073583,5.559172609729028,0.856263783066161,0.35321717),
c("GO:0016832","aldehyde-lyase activity",0.18000591497615526,2.4488226616326765,5.4671880396724655,4.8184370493161355,0.8705750725028275,0.62985729),
c("GO:0016840","carbon-nitrogen lyase activity",0.26838876180780397,2.1757666911884903,5.264349013643432,4.991912427390955,0.8819034334954188,0.43506717),
c("GO:0016920","pyroglutamyl-peptidase activity",0.010524566947839492,6.665535419723846,1.7738740288908044,3.5854607295085006,0.932480696082662,0.31935151),
c("GO:0016989","sigma factor antagonist activity",0.008282388486621413,6.323787569279044,-2.063994016325708,3.481442628502305,0.9752982456395392,0.15541818),
c("GO:0019808","polyamine binding",0.023865528792087056,-2.968343217814205,-7.567269688937631,3.9409644934927996,0.9982111508052154,0),
c("GO:0030975","thiamine binding",0.018580003224362002,-3.8347568064596396,-7.418789015417816,3.832253370197008,0.9946895023993112,0.1802912),
c("GO:0030983","mismatched DNA binding",0.11158392517730163,-2.3650915302724846,-8.070734534107936,4.61075595277859,0.9973303539641457,0.03273832),
c("GO:0034386","4-aminobutyrate:2-oxoglutarate transaminase activity",0.008465590873086794,1.2934724296009372,-3.3239133572734776,3.490941205356787,0.9043675049536468,0.49607265),
c("GO:0043772","acyl-phosphate glycerol-3-phosphate acyltransferase activity",0.01800578678917201,0.13008735350200504,-6.158239973271946,3.818621726375889,0.8758563322530445,0.39105518),
c("GO:0043800","hexulose-6-phosphate isomerase activity",0.0004019515046329969,-1.3580844793248534,6.794105142787671,2.1702617153949575,0.9620751724280723,0.01391246),
c("GO:0043858","arginine:ornithine antiporter activity",0.0008066373732430891,-4.995678190931048,5.4434854686108585,2.4712917110589387,0.9366575488953609,0.24187631),
c("GO:0043878","glyceraldehyde-3-phosphate dehydrogenase (NAD+) (non-phosphorylating) activity",0.015542124845809214,-6.908207654104584,-0.661397473511656,3.7547304690237535,0.8177410735739588,0.54243941),
c("GO:0046857","oxidoreductase activity, acting on other nitrogenous compounds as donors, with NAD or NADP as acceptor",0.04765176102883835,-5.46448100098884,-1.6129088128745304,4.241247551263716,0.8249233686283589,0.26021372),
c("GO:0047112","pyruvate oxidase activity",0.0008695277447162791,-7.049832929831584,0.08504134825557708,2.503790683057181,0.8434624917888623,0.1723729),
c("GO:0047200","tetrahydrodipicolinate N-acetyltransferase activity",0.003251158768766213,-0.3937743331879733,-6.713956264765176,3.0755469613925306,0.8799003061548657,0.1394192),
c("GO:0047348","glycerol-3-phosphate cytidylyltransferase activity",0.001998820067256604,4.22621124665405,-4.929611682846072,2.864511081058392,0.8878168717314294,0.22137094),
c("GO:0047434","indolepyruvate decarboxylase activity",0.0005304666115564722,2.7914006176278927,5.085674580009981,2.290034611362518,0.900526022174756,0.38952912),
c("GO:0047451","3-hydroxyoctanoyl-[acyl-carrier-protein] dehydratase activity",8.749964726704695E-05,1.546625467602438,5.827385098416582,1.5185139398778875,0.9139542193302933,0.01310388),
c("GO:0047456","2-methylisocitrate dehydratase activity",0.012914401063820712,1.8271554624413424,5.399061345664414,3.6743098889414774,0.8921255544302045,0.40317592),
c("GO:0047482","UDP-N-acetylmuramoyl-L-alanyl-D-glutamate-L-lysine ligase activity",0.00046210751212909175,-0.13568412292501442,2.186309794218197,2.230448921378274,0.9682611334467286,-0),
c("GO:0047605","acetolactate decarboxylase activity",0.0034179549713690216,2.822608794369126,5.493150325423652,3.09725730969342,0.8917817652769138,0.45549652),
c("GO:0047746","chlorophyllase activity",0.0024964743110879335,4.621420067295526,1.2919967165836337,2.960946195733831,0.9332605715362645,0.12893285),
c("GO:0047760","butyrate-CoA ligase activity",0.0005085916997397104,0.23475483954445367,1.7754686403913293,2.271841606536499,0.9681382921113971,0.26782947),
c("GO:0047810","D-alanine:2-oxoglutarate aminotransferase activity",0.002518349222904695,1.3203068450880988,-2.730337128815307,2.9647309210536292,0.909761162675653,0.01826331),
c("GO:0047936","glucose 1-dehydrogenase [NAD(P)] activity",0.011407766512441247,-6.007168383280718,-2.813767042966622,3.620448384711709,0.8215567566007147,0.46427269),
c("GO:0050044","galactose-6-phosphate isomerase activity",0.0007601531856324704,-1.3970056929762347,7.107902159043214,2.4456042032735974,0.9571687987388039,0.3001879),
c("GO:0050150","o-pyrocatechuate decarboxylase activity",7.656219135866609E-05,3.1008790261158055,5.314527834313527,1.462397997898956,0.9082772266087753,0.2308698),
c("GO:0051996","squalene synthase activity",0.006321849515044143,5.4426071156687525,-3.9545456299446458,3.3641756327706194,0.8942918451570331,0.48780104),
c("GO:0052693","epoxyqueuosine reductase activity",0.014801112208016413,-4.953798247506075,-2.899553765035527,3.7335182514344876,0.8548963044343075,0.20641124),
c("GO:0070038","rRNA (pseudouridine-N3-)-methyltransferase activity",0.016701495172097586,4.048086935547128,-2.7628566556955807,3.7859701251320095,0.8847892426901462,0.19147382),
c("GO:0097163","sulfur carrier activity",0.015285094631962266,1.4231868928109783,0.7778331020809387,3.747489492258673,0.9862973693287981,-0),
c("GO:0102223","4,4'-diapophytoene desaturase (4,4'-diaponeurosporene-forming)",0.0003499985890681878,-6.4105949431718825,1.2225509663342724,2.110589710299249,0.8792351038511868,0.01383497));

one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$log_size <- as.numeric( as.character(one.data$log_size) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);


# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below

p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = uniqueness, size = log_size), alpha = I(0.6) );
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$uniqueness), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = log_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) ));
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);


# --------------------------------------------------------------------------
# Output the plot to screen

p1;

# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).

# ggsave("/path_to_your_file/revigo-plot.pdf");

